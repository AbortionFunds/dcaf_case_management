<div class="report-section">
  <div class="row">
    <h4 class="col-sm-8"><strong>Budget bar, design TK</strong></h4>
  </div>
  <!-- UNCOMMENT WHEN BUDGET BAR IS READY
  <div id="budget_bar">
    <div class="progress"></div>
    <div class="progress-bar progress-bar-striped"</div>
  </div>
   -->
  <h2 class="border-bottom">Week of <%= week_range %></h2>
  <div class="row">
    <div id='chart-weekly_report'></div>
    <% lines.each do |line| %>
      <div class="col-sm-4">
        <h3><%= link_to line, '#', class: 'line-header' %></h3>

        <p>Patients contacted: <strong><%= weekly_report[line.to_sym][:patients_contacted] %></strong></p>
        <p>New patients contacted: <strong><%= weekly_report[line.to_sym][:new_patients_contacted] %></strong></p>
        <p>Pledges sent: <strong><%= weekly_report[line.to_sym][:pledges_sent] %></strong></p>
      </div>
    <% end %>
  </div>
</div>

<%= javascript_tag do %>
  $(function() {
    ['weekly_report'].forEach(function(reportName) {
      var chart = c3.generate({
        transition: {
          duration: 2000
        },
        bindto: '#chart-' + reportName,
        data: {
            json: [
              gon[reportName]['DC'],
              gon[reportName]['MD'],
              gon[reportName]['VA']
            ],
            type: 'bar',
            keys: {
              x: 'name',
              value: ['patients_contacted', 'new_patients_contacted', 'pledges_sent'],
            }
        },
        bar: {
            width: {
                ratio: 0.5
            }
        },
        axis: {
          x: {
            type: 'category'
          }
        }
      });
    });
  });
<% end %>
